function preloader() { let preloader = document.querySelector('.preloader__wrapper'); preloader.style.display = 'none';}setTimeout(preloader, 3000);$(window).scroll(function () { var top = $(document).scrollTop(); if (top < 500) $(".header").removeClass('fixed'); else $(".header").addClass('fixed');});var swiper = new Swiper('.main', { slidesPerView: 1, pagination: { el: '.swiper-pagination', type: 'bullets', dynamicBullets: true }, autoplay: { delay: 6000, disableOnInteraction: false },});var mySwiper = new Swiper('.banner__slider', { loop: true, slidesPerView: 4, autoplay: { delay: 2000, disableOnInteraction: false }, breakpoints: { 320: { slidesPerView: 2, }, 480: { slidesPerView: 3, }, 700: { slidesPerView: 4, } }});$('.item__add-btn').on('click', function () { var cart = $('.shop__delivery-btn'); var imgtodrag = $(this).closest('.item').find('img').eq(0); if (imgtodrag) { var imgclone = imgtodrag.clone().offset({ top: imgtodrag.offset().top, left: imgtodrag.offset().left }).css({ 'opacity': '0.6', 'position': 'absolute', 'height': '150px', 'width': '150px', 'z-index': '100' }).appendTo($('body')).animate({ 'top': cart.offset().top + 10, 'left': cart.offset().left + 10, 'width': 75, 'height': 75 }, 1000, 'easeInOutExpo'); setTimeout(function () { cart.effect('shake', { times: 1 }, 700); }, 900); imgclone.animate({ 'width': 0, 'height': 0 }, function () { $(this).detach() }); }});const popupLinks = document.querySelectorAll('.popup-link');const body = document.querySelector('body');const lockPadding = document.querySelectorAll(".lock-padding");let keepShop = document.querySelector('#keep-shopping');keepShop.addEventListener('click', function (e) { e.preventDefault(); document.querySelector('.popup').classList.remove('open'); body.classList.remove('lock');});let unlock = true;const timeout = 800;if (popupLinks.length > 0) { for (let index = 0; index < popupLinks.length; index++) { const popupLink = popupLinks[index]; popupLink.addEventListener("click", function (e) { const popupName = popupLink.getAttribute('href').replace('#', ''); const curentPopup = document.getElementById(popupName); popupOpen(curentPopup); e.preventDefault(); }); }};const popupCloseIcon = document.querySelectorAll('.close-popup');if (popupCloseIcon.length > 0) { for (let index = 0; index < popupCloseIcon.length; index++) { const el = popupCloseIcon[index]; el.addEventListener('click', function (e) { popupClose(el.closest('.popup')); e.preventDefault(); }); }};function popupOpen(curentPopup) { if (curentPopup && unlock) { const popupActive = document.querySelector('.popup.open'); if (popupActive) { popupClose(popupActive, false); } else { bodyLock(); } curentPopup.classList.add('open'); curentPopup.addEventListener("click", function (e) { if (!e.target.closest('.popup__content')) { popupClose(e.target.closest('.popup')); } }); }};function popupClose(popupActive, doUnlock = true) { if (unlock) { popupActive.classList.remove('open'); if (doUnlock) { bodyUnLock(); } }};function bodyLock() { const lockPaddingValue = window.innerWidth - document.querySelector('.wrapper').offsetWidth + 'px'; if (lockPadding.length > 0) { for (let index = 0; index < lockPadding.length; index++) { const el = lockPadding[index]; el.style.paddingRight = lockPaddingValue; } } body.style.paddingRight = lockPaddingValue; body.classList.add('lock'); unlock = false; setTimeout(function () { unlock = true; }, timeout);};function bodyUnLock() { setTimeout(function () { if (lockPadding.length > 0) { for (let index = 0; index < lockPadding.length; index++) { const el = lockPadding[index]; el.style.paddingRight = '0px'; } } body.style.paddingRight = '0px'; body.classList.remove('lock'); }, timeout); unlock = false; setTimeout(function () { unlock = true; }, timeout);};document.addEventListener('keydown', function (e) { if (e.which === 27) { const popupActive = document.querySelector('.popup.open'); popupClose(popupActive); }});(function () { if (!Element.prototype.closest) { Element.prototype.closest = function (css) { var node = this; while (node) { if (node.matches(css)) return node; else node = node.parentElement; } return null; }; }})();(function () { if (!Element.prototype.matches) { Element.prototype.matches = Element.prototype.matchesSelector || Element.prototype.webkitMatchesSelector || Element.prototype.mozMatchesSelector || Element.prototype.msMatchesSelector; }})();$('img.img-svg').each(function () { var $img = $(this); var imgClass = $img.attr('class'); var imgURL = $img.attr('src'); $.get(imgURL, function (data) { var $svg = $(data).find('svg'); if (typeof imgClass !== 'undefined') { $svg = $svg.attr('class', imgClass + ' replaced-svg'); } $svg = $svg.removeAttr('xmlns:a'); if (!$svg.attr('viewBox') && $svg.attr('height') && $svg.attr('width')) { $svg.attr('viewBox', '0 0 ' + $svg.attr('height') + ' ' + $svg.attr('width')) } $img.replaceWith($svg); }, 'xml');});var map;DG.then(function () { map = DG.map('map', { center: [42.875405,74.589133], zoom: 20 }); DG.marker([42.875405,74.589133]).addTo(map);});$("#phone").mask("+996 (000) 000-000");jQuery('.btn-send').click(function () { let totalCartArray = []; let shopList = document.querySelector('.wish__list').childNodes; for (let i = 0; i < shopList.length; i++) { let orderList = {}; orderList.name = shopList[i].querySelector('.wish__name').innerText; orderList.quantity = shopList[i].querySelector('.item-count').value; orderList.price = shopList[i].querySelector('.price').innerText; orderList.spicy = shopList[i].querySelector('.spicy-input').checked; totalCartArray.push(orderList); }; document.querySelector('.input-order').value =JSON.stringify(totalCartArray,''); var form = jQuery(this).closest('form'); if (form.valid()) { form.css('opacity', '.5'); var actUrl = form.attr('action'); jQuery.ajax({ url: actUrl, type: 'post', dataType: 'html', data: form.serialize(), success: function (data) { form.html(data); form.css('opacity', '1'); /* form.find('.status').html('форма отправлена успешно'); */ }, error: function () { form.find('.status').html('серверная ошибка'); } }); }; totalCartArray = [];});$('body').on('input blur', '.form-group__input', function (event) { let $elem = $(this); if ($elem.prev('.form-group__placeholder').length > 0) { if ($elem.val().length == 0) { $elem.prev('.form-group__placeholder').removeClass('active') } else { $elem.prev('.form-group__placeholder').addClass('active') } }});$('body').on('focus', '.form-group__input', function (event) { let $elem = $(this); if ($elem.prev('.form-group__placeholder').length > 0 || $elem.hasClass('error')) { $elem.prev('.form-group__placeholder').addClass('active') }});