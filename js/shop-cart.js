let cartWrapper = document.querySelector('.main-popup');let empty = document.querySelector('.empty-block');let widthModal = document.querySelector('.popup__content');let checkCount = function () { if (shoppingCart.totalCount() == 0) { cartWrapper.classList.remove('on'); empty.classList.add('on'); widthModal.classList.add('on') } else { cartWrapper.classList.add('on'); empty.classList.remove('on'); widthModal.classList.remove('on'); };};var shoppingCart = (function () { cart = []; function Item(image, name, price, count) { this.image = image; this.name = name; this.price = price; this.count = count; }; function saveCart() { sessionStorage.setItem('shoppingCart', JSON.stringify(cart)); }; function loadCart() { cart = JSON.parse(sessionStorage.getItem('shoppingCart')); }; if (sessionStorage.getItem("shoppingCart") != null) { loadCart(); }; var obj = {}; obj.addItemToCart = function (image, name, price, count) { for (var item in cart) { if (cart[item].name === name) { cart[item].count++; saveCart(); return; } }; var item = new Item(image, name, price, count); cart.push(item); saveCart(); }; obj.setCountForItem = function (name, count) { for (var i in cart) { if (cart[i].name === name) { cart[i].count = count; break; } }; }; obj.removeItemFromCart = function (name) { for (var item in cart) { if (cart[item].name === name) { cart[item].count--; if (cart[item].count === 0) { cart.splice(item, 1); }; break; } }; saveCart(); }; obj.removeItemFromCartAll = function (name) { for (var item in cart) { if (cart[item].name === name) { cart.splice(item, 1); break; } }; saveCart(); }; obj.clearCart = function () { cart = []; saveCart(); }; obj.totalCount = function () { var totalCount = 0; for (var item in cart) { totalCount += cart[item].count; }; return totalCount; }; obj.totalCart = function () { var totalCart = 0; for (var item in cart) { totalCart += cart[item].price * cart[item].count; }; return Number(totalCart.toFixed(2)); }; obj.listCart = function () { var cartCopy = []; for (i in cart) { item = cart[i]; itemCopy = {}; for (p in item) { itemCopy[p] = item[p]; }; itemCopy.total = Number(item.price * item.count).toFixed(2); cartCopy.push(itemCopy) }; return cartCopy; }; return obj;})();$('.item__add-btn').click(function (e) { e.preventDefault(); var image = e.target.closest('.item').querySelector('.product-img').getAttribute('src'); var name = e.target.closest('.item').querySelector('.product-name').innerHTML; var price = e.target.closest('.item').querySelector('.product-price').innerHTML; shoppingCart.addItemToCart(image, name, price, 1); checkCount(); displayCart();});$('.clear-cart').click(function () { shoppingCart.clearCart(); checkCount(); displayCart();});function displayCart() { var cartArray = shoppingCart.listCart(); var output = ""; for (var i in cartArray) { output += "<li class='wish__item'>" + "<div class=\"wish__img-wrapper\"><img src=\"" + cartArray[i].image + "\" alt=\"\" class=\"wish__img\"></div>" + "<div class='wish__name'>" + cartArray[i].name + "</div>" + "<div class='wish__price'><span class='price'>" + cartArray[i].price + " —Å</span></div>" + "<div class='wish__quantity'><button class='minus-item'>-</button>" + "<input type='number' class='item-count form-control' readonly value=\"" + cartArray[i].count + "\">" + "<button class='plus-item'>+</button></div>" + "<button class='wish__delete'><img src='img/modal/delete1.svg' alt=''></button>" + "<div class=\"wish-spicy\"><label class=\"spicy__btn\"><input class='spicy-input' type=\"checkbox\"><span class=\"slider round\"></span></label></div>" + "</li>"; }; checkCount(); $('.popup .wish__list').html(output); $('.total-cart').html(shoppingCart.totalCart()); $('.total-count').html(shoppingCart.totalCount());}$('.popup .main-popup').on("click", ".wish__delete", function (event) { var name = event.target.closest('.wish__item').querySelector('.wish__name').innerHTML; shoppingCart.removeItemFromCartAll(name); checkCount(); displayCart();});$('.popup .main-popup').on("click", ".minus-item", function (event) { var name = event.target.closest('.wish__item').querySelector('.wish__name').innerHTML; shoppingCart.removeItemFromCart(name); checkCount(); displayCart();});$('.popup .main-popup').on("click", ".plus-item", function (event) { var name = event.target.closest('.wish__item').querySelector('.wish__name').innerHTML; var image = event.target.closest('.wish__item').querySelector('.wish__img').getAttribute('src'); shoppingCart.addItemToCart(image, name); checkCount(); displayCart();});displayCart();